Files already downloaded and verified
Files already downloaded and verified
number of labeled pool: 1000
number of unlabeled pool: 24000
number of testing pool: 10000
CIFAR10
fisher_mask_sampling
2 0 training accuracy: 0.097
3 0 training accuracy: 0.183
4 0 training accuracy: 0.219
5 0 training accuracy: 0.247
6 0 training accuracy: 0.288
7 1 training accuracy: 0.288
8 0 training accuracy: 0.3
9 0 training accuracy: 0.315
10 0 training accuracy: 0.348
11 1 training accuracy: 0.34
12 0 training accuracy: 0.382
13 0 training accuracy: 0.388
14 0 training accuracy: 0.409
15 1 training accuracy: 0.402
16 0 training accuracy: 0.417
17 0 training accuracy: 0.437
18 0 training accuracy: 0.472
19 1 training accuracy: 0.465
20 0 training accuracy: 0.476
21 1 training accuracy: 0.454
22 2 training accuracy: 0.461
23 0 training accuracy: 0.496
24 1 training accuracy: 0.492
25 0 training accuracy: 0.505
26 0 training accuracy: 0.509
27 1 training accuracy: 0.494
28 0 training accuracy: 0.524
29 0 training accuracy: 0.544
30 0 training accuracy: 0.554
31 0 training accuracy: 0.557
32 0 training accuracy: 0.559
33 0 training accuracy: 0.561
34 0 training accuracy: 0.572
35 0 training accuracy: 0.606
36 1 training accuracy: 0.602
37 2 training accuracy: 0.596
38 0 training accuracy: 0.618
39 0 training accuracy: 0.619
40 0 training accuracy: 0.632
41 1 training accuracy: 0.628
42 2 training accuracy: 0.62
43 0 training accuracy: 0.659
44 1 training accuracy: 0.654
45 0 training accuracy: 0.677
46 1 training accuracy: 0.66
47 2 training accuracy: 0.666
48 3 training accuracy: 0.664
49 0 training accuracy: 0.683
50 0 training accuracy: 0.684
51 1 training accuracy: 0.675
52 0 training accuracy: 0.687
53 0 training accuracy: 0.707
54 0 training accuracy: 0.715
55 1 training accuracy: 0.691
56 2 training accuracy: 0.673
57 0 training accuracy: 0.724
58 0 training accuracy: 0.731
59 1 training accuracy: 0.729
60 2 training accuracy: 0.709
61 0 training accuracy: 0.737
62 0 training accuracy: 0.76
63 1 training accuracy: 0.727
64 2 training accuracy: 0.742
65 3 training accuracy: 0.756
66 0 training accuracy: 0.765
67 1 training accuracy: 0.747
68 0 training accuracy: 0.79
69 1 training accuracy: 0.759
70 2 training accuracy: 0.787
71 0 training accuracy: 0.807
72 1 training accuracy: 0.795
73 2 training accuracy: 0.78
74 3 training accuracy: 0.79
75 0 training accuracy: 0.824
76 1 training accuracy: 0.809
77 2 training accuracy: 0.819
78 3 training accuracy: 0.82
79 4 training accuracy: 0.824
80 0 training accuracy: 0.844
81 1 training accuracy: 0.829
82 2 training accuracy: 0.834
83 3 training accuracy: 0.836
84 4 training accuracy: 0.835
85 0 training accuracy: 0.847
86 1 training accuracy: 0.845
87 0 training accuracy: 0.863
88 1 training accuracy: 0.841
89 2 training accuracy: 0.849
90 3 training accuracy: 0.85
91 0 training accuracy: 0.873
92 1 training accuracy: 0.86
93 2 training accuracy: 0.844
94 3 training accuracy: 0.848
95 4 training accuracy: 0.869
96 5 training accuracy: 0.867
97 6 training accuracy: 0.858
98 0 training accuracy: 0.88
99 1 training accuracy: 0.878
100 0 training accuracy: 0.89
101 0 training accuracy: 0.898
102 0 training accuracy: 0.9
103 0 training accuracy: 0.904
104 0 training accuracy: 0.911
105 1 training accuracy: 0.908
106 2 training accuracy: 0.907
107 3 training accuracy: 0.908
108 0 training accuracy: 0.925
109 1 training accuracy: 0.917
110 2 training accuracy: 0.924
111 3 training accuracy: 0.919
112 4 training accuracy: 0.919
113 5 training accuracy: 0.912
114 6 training accuracy: 0.895
115 0 training accuracy: 0.926
116 0 training accuracy: 0.927
117 1 training accuracy: 0.915
118 2 training accuracy: 0.924
119 3 training accuracy: 0.926
120 4 training accuracy: 0.925
121 0 training accuracy: 0.929
122 0 training accuracy: 0.935
123 1 training accuracy: 0.929
124 2 training accuracy: 0.935
125 3 training accuracy: 0.928
126 0 training accuracy: 0.94
127 0 training accuracy: 0.946
128 0 training accuracy: 0.952
129 1 training accuracy: 0.947
130 2 training accuracy: 0.935
131 3 training accuracy: 0.94
132 4 training accuracy: 0.95
133 0 training accuracy: 0.961
134 1 training accuracy: 0.942
135 2 training accuracy: 0.947
136 3 training accuracy: 0.951
137 4 training accuracy: 0.954
138 5 training accuracy: 0.945
139 6 training accuracy: 0.948
140 0 training accuracy: 0.966
141 1 training accuracy: 0.948
142 2 training accuracy: 0.962
143 3 training accuracy: 0.954
144 4 training accuracy: 0.959
145 0 training accuracy: 0.967
146 0 training accuracy: 0.968
147 0 training accuracy: 0.97
148 1 training accuracy: 0.968
149 0 training accuracy: 0.975
150 1 training accuracy: 0.967
151 2 training accuracy: 0.969
152 3 training accuracy: 0.967
153 4 training accuracy: 0.966
154 5 training accuracy: 0.963
155 6 training accuracy: 0.973
156 7 training accuracy: 0.974
157 0 training accuracy: 0.981
158 1 training accuracy: 0.966
159 2 training accuracy: 0.958
160 3 training accuracy: 0.969
161 4 training accuracy: 0.956
162 5 training accuracy: 0.978
163 0 training accuracy: 0.983
164 1 training accuracy: 0.971
165 2 training accuracy: 0.978
166 3 training accuracy: 0.976
167 4 training accuracy: 0.979
168 5 training accuracy: 0.973
169 6 training accuracy: 0.974
170 7 training accuracy: 0.98
171 8 training accuracy: 0.983
172 9 training accuracy: 0.979
173 0 training accuracy: 0.987
174 1 training accuracy: 0.974
175 2 training accuracy: 0.983
176 3 training accuracy: 0.983
177 4 training accuracy: 0.98
178 5 training accuracy: 0.966
179 6 training accuracy: 0.965
180 7 training accuracy: 0.964
181 8 training accuracy: 0.982
182 9 training accuracy: 0.98
183 0 training accuracy: 0.988
184 1 training accuracy: 0.98
185 2 training accuracy: 0.976
186 3 training accuracy: 0.976
187 4 training accuracy: 0.985
188 5 training accuracy: 0.988
189 6 training accuracy: 0.987
190 7 training accuracy: 0.984
191 8 training accuracy: 0.977
192 9 training accuracy: 0.988
193 10 training accuracy: 0.981
194 11 training accuracy: 0.984
195 12 training accuracy: 0.982
196 13 training accuracy: 0.983
197 0 training accuracy: 0.99
1000	testing accuracy 0.445
Round 1
Random calculate_mask took  0.07808661460876465  seconds.
log_prob_grads_wrt took  2070.421167612076  seconds.
getting fisher matrix ...
Traceback (most recent call last):
  File "/home/sgchr/active_nn/experiments.py", line 396, in <module>
    main()
  File "/home/sgchr/active_nn/experiments.py", line 387, in main
    exper("FISH",X_tr, Y_tr, idxs_lb, net, handler, args, X_te, Y_te, DATA_NAME)
  File "/home/sgchr/active_nn/experiments.py", line 141, in exper
    output = strategy.query(NUM_QUERY)
  File "/home/sgchr/active_nn/query_strategies/fisher_mask_sampling.py", line 280, in query
    op = torch.sum(torch.matmul(xt_.transpose(1,2), xt_) / (len(xt)), 0).detach().cpu()#.detach().cpu()
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 18.63 GiB (GPU 0; 31.75 GiB total capacity; 18.67 GiB already allocated; 11.80 GiB free; 18.67 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
